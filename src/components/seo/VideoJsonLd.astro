---
interface Props {
	title: string;
	description: string;
	youtubeId: string;
	pubDate: Date;
	duration?: string;
	url: string;
	tags: string[];
}

const { title, description, youtubeId, pubDate, duration, url, tags } = Astro.props;

const thumbnailUrl = `https://i.ytimg.com/vi/${youtubeId}/hqdefault.jpg`;
const embedUrl = `https://www.youtube-nocookie.com/embed/${youtubeId}`;

const schema = {
	"@context": "https://schema.org",
	"@graph": [
		{
			"@type": "VideoObject",
			"name": title,
			"description": description,
			"thumbnailUrl": thumbnailUrl,
			"uploadDate": pubDate.toISOString().substring(0, 10),
			...(duration && { "duration": duration }),
			"embedUrl": embedUrl,
			"author": {
				"@type": "Person",
				"name": "Mingrath Mekavichai",
			},
			"publisher": {
				"@type": "Organization",
				"name": "SMEAI",
				"url": Astro.site?.href,
			},
			"mainEntityOfPage": url,
			"keywords": tags,
			"inLanguage": "th",
		},
		{
			"@type": "BreadcrumbList",
			"itemListElement": [
				{
					"@type": "ListItem",
					"position": 1,
					"name": "หน้าแรก",
					"item": new URL("/", Astro.site).href,
				},
				{
					"@type": "ListItem",
					"position": 2,
					"name": "วิดีโอ",
					"item": new URL("/videos/", Astro.site).href,
				},
				{
					"@type": "ListItem",
					"position": 3,
					"name": title,
				},
			],
		},
	],
};
---

<script type="application/ld+json" set:html={JSON.stringify(schema)} />
