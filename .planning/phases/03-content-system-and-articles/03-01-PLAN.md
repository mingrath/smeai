# Phase 3, Plan 01: Content Foundation & Feed Infrastructure

**Phase Goal**: Ohm can publish Thai-language articles via Markdown with validated frontmatter, and visitors can browse articles by category, read with a polished experience, and subscribe via RSS
**Plan Scope**: Install dependencies, create the content collection with Zod schema, build the Thai-aware reading time plugin, write 2 seed articles, configure sitemap integration, and create the RSS endpoint
**Requirements**: CONT-05 (Zod schema validation), CONT-07 (RSS feed), SEO-03 (XML sitemap)
**Depends on**: Nothing (first plan in phase)

## Context

Phase 2 is complete. The site has BaseLayout.astro, Header/Footer, homepage sections, and contact page. Astro 5.17.2 with Tailwind v4 and Preact. `site` is already set to `https://smeai.pages.dev` in astro.config.mjs. This plan establishes the content pipeline that all subsequent plans depend on.

Key references:
- `@astro.config.mjs` -- needs sitemap integration + remark plugin
- `@src/layouts/BaseLayout.astro` -- unchanged in this plan
- `@.planning/phases/03-content-system-and-articles/03-RESEARCH.md` -- patterns + pitfalls

## Tasks

### Task 1: Install Dependencies, Create Remark Plugin, and Content Collection Schema

**What:** Install the 4 new dependencies, create the Thai-aware reading time remark plugin, define the articles content collection with Zod schema, and update astro.config.mjs with sitemap integration + remark plugin.

**Why:** CONT-05 requires Zod schema validation. The reading time plugin is needed by article pages (Plan 02). The sitemap integration (SEO-03) is zero-config once added. All of these are foundational -- nothing else works without them.

**Files:**
- `package.json` -- add 4 dependencies (via npm install)
- `plugins/remark-reading-time.mjs` -- create Thai-aware reading time remark plugin
- `src/content.config.ts` -- create content collection definition with Zod schema
- `astro.config.mjs` -- add sitemap integration + remarkPlugins config

**Details:**

**Step 1: Install dependencies**
```bash
npm install @astrojs/sitemap @astrojs/rss reading-time mdast-util-to-string
```

**Step 2: Create `plugins/remark-reading-time.mjs`**

This is a custom remark plugin. It MUST use `Intl.Segmenter('th', { granularity: 'word' })` for Thai word counting. The standard `reading-time` package uses space-based splitting which undercounts Thai by ~6x. We import `toString` from `mdast-util-to-string` to extract plain text from the Markdown AST, then count words with `Intl.Segmenter` and compute minutes at 200 WPM. The result is injected into `data.astro.frontmatter.minutesRead` which is accessible via `remarkPluginFrontmatter.minutesRead` after `render()`.

```javascript
// plugins/remark-reading-time.mjs
import { toString } from 'mdast-util-to-string';

const WORDS_PER_MINUTE = 200;

function countWords(text) {
  const segmenter = new Intl.Segmenter('th', { granularity: 'word' });
  const words = [...segmenter.segment(text)].filter((s) => s.isWordLike);
  return words.length;
}

export function remarkReadingTime() {
  return function (tree, { data }) {
    const text = toString(tree);
    const words = countWords(text);
    const minutes = Math.max(1, Math.ceil(words / WORDS_PER_MINUTE));
    data.astro.frontmatter.minutesRead = minutes;
  };
}
```

**Step 3: Create `src/content.config.ts`**

IMPORTANT: This file goes at `src/content.config.ts` (NOT `src/content/config.ts`). Uses `glob()` loader from `astro/loaders`. Uses `z` from `astro/zod`. Dates use `z.coerce.date()` (NOT `z.date()`). Category uses `z.enum()` for a fixed taxonomy with 4 initial categories.

```typescript
// src/content.config.ts
import { defineCollection } from 'astro:content';
import { glob } from 'astro/loaders';
import { z } from 'astro/zod';

const articles = defineCollection({
  loader: glob({ pattern: '**/*.md', base: './src/content/articles' }),
  schema: z.object({
    title: z.string(),
    description: z.string(),
    category: z.enum(['ai-basics', 'tools', 'case-studies', 'news']),
    tags: z.array(z.string()).default([]),
    pubDate: z.coerce.date(),
    lastReviewed: z.coerce.date(),
    draft: z.boolean().default(false),
    seoTitle: z.string().optional(),
    seoKeywords: z.array(z.string()).default([]),
  }),
});

export const collections = { articles };
```

**Step 4: Update `astro.config.mjs`**

Add `@astrojs/sitemap` to integrations array and `remarkReadingTime` to markdown.remarkPlugins. Keep existing preact() integration and vite tailwindcss() plugin.

```javascript
import preact from '@astrojs/preact';
import sitemap from '@astrojs/sitemap';
import tailwindcss from '@tailwindcss/vite';
import { defineConfig } from 'astro/config';
import { remarkReadingTime } from './plugins/remark-reading-time.mjs';

export default defineConfig({
  site: 'https://smeai.pages.dev',
  integrations: [preact(), sitemap()],
  markdown: {
    remarkPlugins: [remarkReadingTime],
  },
  vite: {
    plugins: [tailwindcss()],
  },
});
```

**Verification:**
- [ ] `npm ls @astrojs/sitemap @astrojs/rss reading-time mdast-util-to-string` shows all 4 installed
- [ ] `src/content.config.ts` exists (not `src/content/config.ts`)
- [ ] `plugins/remark-reading-time.mjs` exists
- [ ] `astro.config.mjs` imports sitemap and remarkReadingTime
- [ ] `npm run build` passes (no collections defined yet is OK -- schema is ready)

---

### Task 2: Create Seed Articles and RSS Endpoint

**What:** Create 2 seed articles in Thai (different categories) and the RSS feed endpoint.

**Why:** Seed articles are needed to verify the entire content pipeline works end-to-end (schema validation, reading time plugin, build). The RSS endpoint (CONT-07) completes the feed infrastructure alongside the sitemap.

**Files:**
- `src/content/articles/ai-basics/chatgpt-for-sme.md` -- create seed article 1
- `src/content/articles/tools/line-oa-chatbot.md` -- create seed article 2
- `src/pages/rss.xml.ts` -- create RSS feed endpoint
- `src/lib/categories.ts` -- create category display name lookup

**Details:**

**Step 1: Create category lookup at `src/lib/categories.ts`**

This is the single source of truth for category slugs to Thai display names. Used by article pages, listing pages, and breadcrumbs.

```typescript
// src/lib/categories.ts
export const CATEGORIES = {
  'ai-basics': 'พื้นฐาน AI',
  'tools': 'เครื่องมือ AI',
  'case-studies': 'กรณีศึกษา',
  'news': 'ข่าวสาร AI',
} as const;

export type CategorySlug = keyof typeof CATEGORIES;

export function getCategoryName(slug: CategorySlug): string {
  return CATEGORIES[slug];
}
```

**Step 2: Create seed article 1 at `src/content/articles/ai-basics/chatgpt-for-sme.md`**

This article must have valid frontmatter matching the Zod schema. Write genuine Thai content (minimum 300 words Thai text) with at least 3 h2 headings to test TOC generation. Include Tinglish SEO fields.

```markdown
---
title: "ChatGPT คืออะไร? ทำไม SME ไทยต้องรู้จัก"
description: "เรียนรู้พื้นฐาน ChatGPT และวิธีนำไปใช้จริงในธุรกิจ SME ไทย ตั้งแต่การตอบลูกค้าไปจนถึงการเขียนคอนเทนต์"
category: "ai-basics"
tags: ["chatgpt", "ai", "sme", "เริ่มต้น"]
pubDate: 2026-02-01
lastReviewed: 2026-02-15
draft: false
seoTitle: "ChatGPT for Thai SME - What is ChatGPT"
seoKeywords: ["chatgpt thai", "AI for SME", "chatgpt sme"]
---

## ChatGPT คืออะไร?

ChatGPT เป็นเครื่องมือ AI ประเภท Large Language Model (LLM) ที่พัฒนาโดย OpenAI สามารถเข้าใจและสร้างข้อความภาษาไทยได้อย่างเป็นธรรมชาติ สำหรับเจ้าของธุรกิจ SME ไทย ChatGPT ไม่ใช่แค่ของเล่นเทคโนโลยี แต่เป็นเครื่องมือที่ช่วยลดต้นทุนและเพิ่มประสิทธิภาพการทำงานได้จริง

ลองนึกภาพว่าคุณมีผู้ช่วยที่ทำงานได้ 24 ชั่วโมง ไม่ต้องจ่ายเงินเดือน และสามารถช่วยเขียนอีเมล ตอบคำถามลูกค้า หรือแม้แต่วิเคราะห์ข้อมูลได้ นั่นคือสิ่งที่ ChatGPT ทำได้

## ใช้ ChatGPT ในธุรกิจ SME ได้อย่างไร?

### ตอบลูกค้าอัตโนมัติ

เจ้าของร้านค้าออนไลน์สามารถใช้ ChatGPT ช่วยร่างข้อความตอบลูกค้าที่ถามคำถามซ้ำๆ เช่น เวลาจัดส่ง นโยบายคืนสินค้า หรือรายละเอียดสินค้า แทนที่จะพิมพ์ตอบทีละคน สามารถใช้ ChatGPT สร้างเทมเพลตข้อความที่เป็นธรรมชาติและปรับแต่งได้

### เขียนคอนเทนต์การตลาด

การเขียนโพสต์โซเชียลมีเดีย บทความบล็อก หรือรายละเอียดสินค้า เป็นงานที่กิน SME เวลามาก ChatGPT ช่วยร่างเนื้อหาเบื้องต้นได้ภายในไม่กี่วินาที จากนั้นคุณแค่ปรับแต่งให้ตรงกับแบรนด์ของคุณ

### วิเคราะห์และสรุปข้อมูล

มีรีวิวลูกค้าเยอะแต่ไม่มีเวลาอ่าน? ChatGPT ช่วยสรุปรีวิวจำนวนมากให้เหลือประเด็นสำคัญ หรือช่วยวิเคราะห์แนวโน้มจากข้อมูลขายที่คุณป้อนให้

## เริ่มต้นใช้งาน ChatGPT

1. เข้าไปที่ [chat.openai.com](https://chat.openai.com)
2. สมัครบัญชีฟรี (ใช้ Google หรืออีเมล)
3. เลือกโมเดล GPT-4o (แนะนำสำหรับภาษาไทย)
4. เริ่มพิมพ์คำถามหรือคำสั่งเป็นภาษาไทยได้เลย

**เคล็ดลับ:** ยิ่งให้บริบทมากเท่าไหร่ ChatGPT ยิ่งตอบได้ตรงประเด็น เช่น แทนที่จะพิมพ์ "เขียนโพสต์ขายของ" ให้ลองพิมพ์ "เขียนโพสต์ Facebook ขายเสื้อยืดแบรนด์ไทย กลุ่มเป้าหมายวัยรุ่น ราคา 299 บาท โทนสนุกสนาน"

## สรุป

ChatGPT เป็นเครื่องมือที่เจ้าของ SME ไทยทุกคนควรลองใช้ เริ่มจากงานง่ายๆ เช่น ร่างข้อความ แล้วค่อยขยายไปใช้งานที่ซับซ้อนขึ้น ไม่ต้องเป็นคนไอทีก็ใช้ได้ สิ่งสำคัญคือเริ่มลงมือทำ
```

**Step 3: Create seed article 2 at `src/content/articles/tools/line-oa-chatbot.md`**

Different category (`tools`), also genuine Thai content, at least 2 h2 headings.

```markdown
---
title: "สร้าง Chatbot LINE OA ด้วย AI ไม่ต้องเขียนโค้ด"
description: "วิธีสร้าง chatbot สำหรับ LINE Official Account โดยใช้เครื่องมือ AI สำเร็จรูป เหมาะสำหรับ SME ที่ไม่มีทีมโปรแกรมเมอร์"
category: "tools"
tags: ["line-oa", "chatbot", "no-code", "automation"]
pubDate: 2026-02-10
lastReviewed: 2026-02-15
draft: false
seoTitle: "LINE OA Chatbot with AI - No Code Required"
seoKeywords: ["line oa chatbot", "chatbot ai", "line official account bot"]
---

## ทำไมต้องมี Chatbot บน LINE OA?

LINE เป็นแอปแชทที่คนไทยใช้มากที่สุด ธุรกิจ SME ส่วนใหญ่มี LINE Official Account (LINE OA) สำหรับติดต่อลูกค้า แต่ปัญหาคือ ลูกค้าส่งข้อความมาตลอด 24 ชั่วโมง ในขณะที่เจ้าของธุรกิจหรือพนักงานไม่สามารถตอบได้ตลอดเวลา

Chatbot ช่วยแก้ปัญหานี้โดยตอบคำถามที่พบบ่อยให้อัตโนมัติ เช่น เวลาเปิด-ปิดร้าน ราคาสินค้า สถานะการจัดส่ง โดยที่ลูกค้าไม่ต้องรอ

## เครื่องมือสร้าง Chatbot แบบไม่ต้องเขียนโค้ด

### Dialogflow CX ของ Google

Dialogflow เป็นแพลตฟอร์มสร้าง chatbot จาก Google ที่รองรับภาษาไทย สามารถเชื่อมต่อกับ LINE OA ได้โดยตรง ข้อดีคือมี Free Tier ให้ใช้งานฟรีสำหรับธุรกิจขนาดเล็ก

### Botpress

Botpress เป็นแพลตฟอร์ม open-source สำหรับสร้าง chatbot ที่มี visual flow builder ใช้ลากวางได้ง่าย รองรับ AI ตอบคำถามอัตโนมัติ และเชื่อมต่อ LINE ผ่าน webhook

### การใช้ ChatGPT API ร่วมกับ Make (Integromat)

สำหรับ SME ที่ต้องการ chatbot ฉลาดกว่าระบบ rule-based สามารถใช้ Make.com เชื่อม LINE OA กับ ChatGPT API ได้ โดยไม่ต้องเขียนโค้ดเลย ระบบจะรับข้อความจาก LINE ส่งไปหา ChatGPT แล้วส่งคำตอบกลับมาอัตโนมัติ

## ข้อควรระวัง

- ทดสอบ chatbot ให้ดีก่อนเปิดใช้จริง โดยเฉพาะการตอบคำถามภาษาไทย
- มีตัวเลือกให้ลูกค้าเปลี่ยนไปคุยกับคนจริงได้เสมอ
- ตรวจสอบค่าใช้จ่าย API ก่อนเปิดใช้งาน เพราะ ChatGPT API คิดเงินตามจำนวนข้อความ

## สรุป

การสร้าง chatbot บน LINE OA ไม่จำเป็นต้องเขียนโค้ดอีกต่อไป เครื่องมืออย่าง Dialogflow, Botpress หรือ Make + ChatGPT ช่วยให้ SME ไทยสร้างระบบตอบลูกค้าอัตโนมัติได้ภายในวันเดียว เริ่มจากคำถามที่ถูกถามบ่อยที่สุด แล้วค่อยขยายความสามารถของ bot ไปเรื่อยๆ
```

**Step 4: Create RSS endpoint at `src/pages/rss.xml.ts`**

Uses `@astrojs/rss` helper. Filters out draft articles. Sorts by pubDate descending. Sets language to `th`. Article links use `article.id` (Astro 5 -- NOT `article.slug`).

Note: The `article.id` from the glob loader includes the category directory prefix (e.g., `ai-basics/chatgpt-for-sme`). For the article URL slug, we need just the filename part. Extract it with `article.id.split('/').pop()` or use the full id depending on URL structure. Since our `[slug].astro` page will use `article.id` as the slug param, and we want flat URLs like `/articles/chatgpt-for-sme/`, we should extract just the filename. However, to avoid slug collisions across categories, we will use the full `article.id` path. But `[slug].astro` uses a single param, so we need a flat slug. Solution: Use `article.id.split('/').pop()!` as the slug for URL generation. The `[slug].astro` page will also use this approach consistently.

Actually, re-reading the Astro 5 glob loader docs: when using `glob({ pattern: '**/*.md', base: './src/content/articles' })`, the `id` is the relative path without extension, e.g., `ai-basics/chatgpt-for-sme`. For `[slug].astro` we need a flat slug. Let's derive the slug from the filename portion. We must ensure consistency between the RSS link and the actual page route.

The cleanest approach: in `[slug].astro` getStaticPaths, use `article.id.split('/').pop()` as the slug param. In RSS, use the same derivation for the link.

```typescript
// src/pages/rss.xml.ts
import rss from '@astrojs/rss';
import { getCollection } from 'astro:content';
import type { APIContext } from 'astro';

export async function GET(context: APIContext) {
  const articles = await getCollection('articles', ({ data }) => !data.draft);

  return rss({
    title: 'SMEAI - AI สำหรับ SME ไทย',
    description: 'บทความและคำแนะนำเกี่ยวกับการใช้ AI ในธุรกิจ SME ไทย',
    site: context.site!,
    items: articles
      .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
      .map((article) => {
        const slug = article.id.split('/').pop()!;
        return {
          title: article.data.title,
          pubDate: article.data.pubDate,
          description: article.data.description,
          link: `/articles/${slug}/`,
        };
      }),
    customData: '<language>th</language>',
  });
}
```

**Verification:**
- [ ] `npm run build` passes with no schema validation errors
- [ ] Build output includes `sitemap-index.xml` in `dist/`
- [ ] Build output includes `rss.xml` in `dist/`
- [ ] `cat dist/rss.xml` contains both article titles in Thai
- [ ] `cat dist/sitemap-index.xml` contains a sitemap reference
- [ ] The remark plugin runs (check build logs for no errors related to `remarkReadingTime`)
- [ ] `src/lib/categories.ts` exports CATEGORIES and getCategoryName

## Plan Verification

- [ ] `npm run build` completes without errors
- [ ] `dist/rss.xml` is valid XML with 2 article entries and `<language>th</language>`
- [ ] `dist/sitemap-index.xml` exists and references numbered sitemap files
- [ ] Zod schema validates both seed articles (build would fail if not)
- [ ] `src/content.config.ts` is at the correct Astro 5 location (not inside `src/content/`)
- [ ] Category lookup has all 4 categories with Thai display names
