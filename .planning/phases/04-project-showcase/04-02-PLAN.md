---
phase: 04-project-showcase
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - src/layouts/ProjectLayout.astro
  - src/pages/showcase/index.astro
  - src/pages/showcase/[slug].astro
  - src/components/landing/FeaturedProjects.astro
  - src/pages/index.astro
autonomous: true

must_haves:
  truths:
    - "Visiting /showcase/ shows a grid of portfolio cards with project thumbnails and descriptions"
    - "Visiting /showcase/{slug}/ shows a case study page with Problem -> Solution -> Results structure and a business metric"
    - "Homepage displays featured projects section pulling from the projects collection"
    - "Case study pages have CreativeWork JSON-LD structured data and proper OG meta"
  artifacts:
    - path: "src/layouts/ProjectLayout.astro"
      provides: "Layout wrapper for individual case study pages"
      min_lines: 30
    - path: "src/pages/showcase/index.astro"
      provides: "Project listing grid page at /showcase/"
      contains: "getCollection"
    - path: "src/pages/showcase/[slug].astro"
      provides: "Dynamic case study detail pages"
      contains: "getStaticPaths"
    - path: "src/components/landing/FeaturedProjects.astro"
      provides: "Homepage section showing featured projects"
      contains: "featured"
    - path: "src/pages/index.astro"
      provides: "Homepage with FeaturedProjects section added"
      contains: "FeaturedProjects"
  key_links:
    - from: "src/pages/showcase/index.astro"
      to: "src/components/project/ProjectCard.astro"
      via: "import and render in grid"
      pattern: "ProjectCard"
    - from: "src/pages/showcase/[slug].astro"
      to: "src/layouts/ProjectLayout.astro"
      via: "layout wrapper"
      pattern: "ProjectLayout"
    - from: "src/pages/showcase/[slug].astro"
      to: "src/content.config.ts"
      via: "getCollection('projects')"
      pattern: "getCollection.*projects"
    - from: "src/components/landing/FeaturedProjects.astro"
      to: "src/components/project/ProjectCard.astro"
      via: "import and render featured cards"
      pattern: "ProjectCard"
    - from: "src/pages/index.astro"
      to: "src/components/landing/FeaturedProjects.astro"
      via: "import and render between Services and CallToAction"
      pattern: "FeaturedProjects"
---

<objective>
Wire project pages (listing + detail), create ProjectLayout, build the FeaturedProjects homepage section, and integrate into the homepage.

Purpose: Delivers the user-facing showcase experience -- visitors can browse all projects, read individual case studies, and discover featured projects from the homepage.
Output: Working /showcase/ listing, /showcase/[slug] detail pages, and featured projects on homepage.
</objective>

<execution_context>
@/Users/ohmmingrath/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ohmmingrath/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-project-showcase/04-RESEARCH.md
@.planning/phases/04-project-showcase/04-01-SUMMARY.md

# Existing patterns to mirror:
@src/layouts/ArticleLayout.astro
@src/pages/articles/[slug].astro
@src/pages/articles/[...page].astro
@src/pages/index.astro
@src/components/landing/Services.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ProjectLayout, showcase listing page, and case study detail page</name>
  <files>
    src/layouts/ProjectLayout.astro
    src/pages/showcase/index.astro
    src/pages/showcase/[slug].astro
  </files>
  <action>
**ProjectLayout.astro** — Mirror ArticleLayout.astro but adapted for case studies.

Props: `{ project: CollectionEntry<'projects'>; headings: { depth: number; slug: string; text: string }[]; readingTime: number }`

Structure:
- Wrap in `BaseLayout` with `title` (use `data.seoTitle || data.title`), `description`, `ogType="article"`, `publishedTime={data.pubDate}`, `tags={data.tags}`.
- Include `ProjectJsonLd` (from Plan 01) with title, description, pubDate, url (built from `Astro.url.pathname` + `Astro.site`), tags.
- `<article>` container with `py-12 md:py-16` and inner `prose-container` div.
- Project title as `<h1>` with same classes as ArticleLayout.
- Meta row below title: industry badge (same accent styling as ProjectCard), client name, Thai-formatted pubDate, and reading time in a flex row with `text-sm text-surface-500 dark:text-surface-400` and separating dots.
- Business metric highlight box: a `rounded-xl bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-800 p-4 mb-8` box showing `data.metric` prominently (`text-3xl font-bold text-primary-600 dark:text-primary-400`) with `data.metricLabel` alongside.
- Prose body: `<div class="prose prose-lg dark:prose-invert max-w-none"><slot /></div>` for the markdown content.
- Tags display below prose (if tags exist): flex-wrap row of tag badges matching ArticleCard style.
- Back link at bottom: "กลับไปหน้าผลงาน" linking to `/showcase/` with left arrow SVG (same pattern as ArticleLayout's "กลับไปหน้าบทความ").

NO TableOfContents needed -- case studies are shorter than articles. Keep it simple.

**showcase/index.astro** — Flat listing page (no pagination -- portfolio is small).

Structure:
- `getCollection('projects', ({ data }) => !data.draft)` sorted by pubDate desc.
- Wrap in `BaseLayout` with title="ผลงาน" and appropriate Thai description.
- Page header: `<h1>` "ผลงาน" + subtitle `<p>` "ตัวอย่างโปรเจกต์ AI ที่ช่วยธุรกิจ SME จริง".
- Grid: `grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6` with `<ProjectCard>` for each project.
- Empty state: if no projects, show Thai message "ยังไม่มีผลงาน" (matching articles empty state pattern).
- Use `max-w-5xl mx-auto px-4` container (matching articles listing).

**showcase/[slug].astro** — Dynamic case study pages.

Mirror `articles/[slug].astro` exactly:
```
export async function getStaticPaths() {
  const projects = await getCollection('projects', ({ data }) => !data.draft);
  return projects.map((project) => ({
    params: { slug: project.id.split('/').pop()! },
    props: { project },
  }));
}
```
- Import and call `render(project)` to get `Content`, `headings`, `remarkPluginFrontmatter`.
- Pass `project`, `headings`, and `remarkPluginFrontmatter.minutesRead` as readingTime to `<ProjectLayout>`.
- Render `<Content />` as the slot.
  </action>
  <verify>
Run `npx astro build` to confirm all pages generate without errors. Check that the build output includes `/showcase/index.html` and one `/showcase/{slug}/index.html` per seed project (3 total).
  </verify>
  <done>
/showcase/ displays a grid of project cards, /showcase/{slug}/ shows full case study with Project metadata, business metric highlight, and prose content. All 3 seed projects render as detail pages.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create FeaturedProjects landing section and add to homepage</name>
  <files>
    src/components/landing/FeaturedProjects.astro
    src/pages/index.astro
  </files>
  <action>
**FeaturedProjects.astro** — New landing section component.

Query projects: `getCollection('projects', ({ data }) => !data.draft && data.featured)` sorted by pubDate desc, sliced to first 3.

Section structure (follow Services.astro pattern for consistent landing page rhythm):
- `<section id="projects" class="py-16 md:py-24 bg-surface-100 dark:bg-surface-900">` -- use alternating background (Services is transparent, so FeaturedProjects uses surface-100/900, then CallToAction returns to primary gradient).
- Inner container: `max-w-5xl mx-auto px-4`.
- Header: centered `<h2>` "ผลงาน" + `<p>` "ตัวอย่างโปรเจกต์ AI ที่ช่วยธุรกิจ SME จริง" with same classes as Services section header.
- Grid: `grid sm:grid-cols-2 lg:grid-cols-3 gap-6` rendering `<ProjectCard>` for each featured project.
- "View all" link below grid: centered `<a href="/showcase/">` with text "ดูผลงานทั้งหมด" and a right arrow SVG (Heroicons `arrow-right` outline, w-4 h-4), styled as `text-primary-600 dark:text-primary-400 font-medium hover:underline`.
- If no featured projects exist (empty array), render nothing (return early or conditional render) -- don't show an empty section on the homepage.

**index.astro** — Add FeaturedProjects between Services and CallToAction.

Update the homepage to import and render `FeaturedProjects`:
```astro
---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/landing/Hero.astro';
import About from '../components/landing/About.astro';
import Services from '../components/landing/Services.astro';
import FeaturedProjects from '../components/landing/FeaturedProjects.astro';
import CallToAction from '../components/landing/CallToAction.astro';
---
<BaseLayout title="Home" description="ช่วย SME ไทยนำ AI มาใช้ในธุรกิจอย่างคุ้มค่า พร้อมคำปรึกษาจากผู้เชี่ยวชาญ">
  <Hero />
  <About />
  <Services />
  <FeaturedProjects />
  <CallToAction />
</BaseLayout>
```

Keep the existing description and title exactly as they are.
  </action>
  <verify>
Run `npx astro build` successfully. Then run `npx astro preview` and verify:
1. Homepage at `/` shows the FeaturedProjects section with 3 project cards between Services and CallToAction
2. The "ดูผลงานทั้งหมด" link navigates to `/showcase/`
3. Clicking a project card from homepage navigates to the correct `/showcase/{slug}/` detail page
  </verify>
  <done>
Homepage displays featured projects section with up to 3 project cards pulled from the projects collection. Cards link to individual case study pages. "ดูผลงานทั้งหมด" links to /showcase/ listing.
  </done>
</task>

</tasks>

<verification>
1. `npx astro build` succeeds with zero errors
2. Build output includes: `/showcase/index.html`, `/showcase/sme-ai-chatbot/index.html`, `/showcase/retail-inventory-forecast/index.html`, `/showcase/clinic-line-bot/index.html`
3. Homepage HTML includes the FeaturedProjects section with project card links
4. Case study detail pages include JSON-LD with `CreativeWork` type
5. Case study detail pages show business metric highlight, prose content with Problem/Solution/Results headings, and "กลับไปหน้าผลงาน" back link
</verification>

<success_criteria>
- /showcase/ lists all non-draft projects in a responsive card grid (SHOW-01)
- /showcase/{slug}/ renders case study with Problem -> Solution -> Results markdown structure (SHOW-02)
- Case study pages display at least one concrete business metric prominently (SHOW-03)
- Homepage shows featured projects section between Services and CallToAction (SHOW-04)
- All pages have proper SEO: og:type article, CreativeWork JSON-LD, BreadcrumbList, canonical URLs
- `npx astro build` completes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-project-showcase/04-02-SUMMARY.md`
</output>
